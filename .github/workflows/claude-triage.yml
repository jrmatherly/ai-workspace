name: Claude Issue Triage

on:
  issues:
    types: [opened]

jobs:
  triage:
    runs-on: ubuntu-latest

    permissions:
      contents: read
      issues: write
      id-token: write

    steps:
      - name: Checkout
        uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8 # v6

      - name: Claude Triage
        uses: anthropics/claude-code-action@a017b830c03e23789b11fb69ed571ea61c12e45c # v1
        with:
          claude_code_oauth_token: ${{ secrets.CLAUDE_CODE_OAUTH_TOKEN }}

          prompt: |
            Analyze this issue and provide a brief triage:

            1. **Identify Project**: Which project does this relate to?
               - obot-entraid: Full-stack MCP platform
               - nah: Kubernetes controller framework
               - kinm: Kubernetes-like API server
               - mcp-oauth-proxy: OAuth 2.1 proxy
               - obot-tools: GPTScript tools and providers
               - mcp-catalog: MCP server catalog
               - namegenerator: Name generator
               - workspace root: Shared configuration

            2. **Suggest Labels**: Based on the issue type
               - bug: Something isn't working
               - enhancement: New feature or request
               - documentation: Docs improvement
               - question: Information needed
               - security: Security-related

            3. **Identify Files**: If it's a bug, list likely affected files

            4. **Architecture Notes**: If it's a feature request, note any
               architectural considerations from AGENTS.md or project CLAUDE.md

            Keep response under 200 words.
            Format with clear sections for easy scanning.
